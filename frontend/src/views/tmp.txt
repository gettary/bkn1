<div v-else>
          <el-collapse v-model="activeAssessments" accordion>
            <el-collapse-item
              v-for="assessment in publishedAssessments"
              :key="assessment.id"
              :title="assessment.name"
              :name="assessment.id"
              @click="loadAssessmentReport(assessment.id)"              
            >
              <div v-if="reportData[assessment.id]" class="report-content">
                <div
                  v-for="(item, itemIndex) in reportData[assessment.id]"
                  :key="`item-${itemIndex}`"
                  class="report-item"
                >
                  <h3 class="item-title">{{ item.title }}</h3>

                  <el-collapse
                    v-for="(indicator, indicatorIndex) in item.indicators"
                    :key="`indicator-${indicatorIndex}`"
                    :title="indicator?.title || 'ไม่มีชื่อ'"
                    :name="indicatorIndex"
                  >
                    <el-collapse-item v-if="indicator && indicator.title" v-model="activeIndicators[indicator.indicator_id]">
                      <el-card class="indicator-card">
                        <template #header>                          
                          <div class="indicator-header">
                            <h4>{{ indicator.title || 'ไม่มีชื่อ' }}</h4>
                            <div v-if="canManageAssessments && indicator.permissions" class="permissions-info">
                              <el-tag
                                v-for="perm in indicator.permissions"
                                :key="perm.user_name"
                                size="small"
                                type="info"
                              >
                                {{ perm.user_name }}
                              </el-tag>
                            </div>
                          </div>
                        </template>

                        <div class="indicator-items">
                          <el-table
                            :data="indicator.items"
                            style="width: 100%"
                            size="small"
                          >
                            <el-table-column
                              prop="title"
                              label="รายการตัวชี้วัด"
                              min-width="200"
                            />
                            <el-table-column
                              prop="target_value"
                              label="ค่าเป้าหมาย"
                              width="120"
                              align="center"
                            />
                            <el-table-column
                              label="ผลงาน 3 ปีย้อนหลัง"
                              align="center"
                            >
                              <el-table-column 
                                prop="past_2565" 
                                label="ปี 2565"
                                width="60"
                                align="center" 
                              />
                              <el-table-column 
                                prop="past_2566" 
                                label="ปี 2566"
                                width="60"
                                align="center" 
                              />
                              <el-table-column 
                                prop="past_2567" 
                                label="ปี 2567" 
                                width="60"
                                align="center"
                              />        
                            </el-table-column>
                            <el-table-column
                              label="ผลงาน 3 ปีย้อนหลัง"
                              align="center"
                            >
                              <el-table-column
                                prop="actual_target"
                                label="เป้าหมายจริง"
                                width="60"
                                align="center"
                              />
                              <el-table-column
                                prop="performance"
                                label="ผลงาน"
                                width="60"
                                align="center"
                              >
                                <template #default="{ row }">
                                  <div v-if="getItemUserData(indicator.user_data, row.id).length > 0">
                                    {{ getItemUserData(indicator.user_data, row.id)[0].data.performance || '-' }}
                                  </div>
                                  <div v-else>
                                    -
                                  </div>
                                </template>
                              </el-table-column>
                              <el-table-column
                                prop="rate"
                                label="อัตรา"
                                width="60"
                                align="center"
                              >
                                <template #default="{ row }">
                                  <div v-if="getItemUserData(indicator.user_data, row.id).length > 0">
                                    {{ getItemUserData(indicator.user_data, row.id)[0].data.rate || '-' }}
                                  </div>
                                  <div v-else>
                                    -
                                  </div>
                                </template>
                              </el-table-column>
                            </el-table-column>
                            <el-table-column
                              prop="score"
                              label="คะแนน"
                              width="60"
                              align="center"
                            >
                              <template #default="{ row }">
                                <div v-if="getItemUserData(indicator.user_data, row.id).length > 0">
                                  {{ getItemUserData(indicator.user_data, row.id)[0].data.score || '-' }}
                                </div>
                                <div v-else>
                                  -
                                </div>
                              </template>
                            </el-table-column>
                            <el-table-column
                              label="รูปภาพ"
                              width="60"
                              align="center"
                            >
                              <template #default="{ row }">
                                <div v-if="getItemUserData(indicator.user_data, row.id).length > 0">
                                  <div v-if="getItemUserData(indicator.user_data, row.id)[0].data.image_path">
                                    <el-button
                                      type="primary"
                                      size="small"
                                      @click="viewImage(getItemUserData(indicator.user_data, row.id)[0].data.image_path)"
                                    >
                                      <el-icon><View /></el-icon>
                                      ดูรูปภาพ
                                    </el-button>
                                  </div>
                                  <div v-else>
                                    ไม่มีรูปภาพ
                                  </div>
                                </div>
                                <div v-else>
                                  ไม่มีข้อมูล
                                </div>
                              </template>
                            </el-table-column>
                            <el-table-column
                              label="สถานะการกรอกข้อมูล"
                              width="100"
                              align="center"
                            >
                              <template #default="{ row }">
                                <div class="status-info">
                                  <div
                                    v-for="userData in getItemUserData(indicator.user_data, row.id)"
                                    :key="userData.user_name"
                                    class="user-status"
                                  >
                                    <span class="user-name">{{ userData.user_name }}:</span>
                                    <el-tag
                                      :type="userData.status === 'complete' ? 'success' : 'warning'"
                                      size="small"
                                    >
                                      {{ userData.status === 'complete' ? 'เสร็จสิ้น' : 'ร่าง' }}
                                    </el-tag>
                                  </div>
                                  <div v-if="getItemUserData(indicator.user_data, row.id).length === 0" class="no-data-text">
                                    ยังไม่มีข้อมูล
                                  </div>
                                </div>
                              </template>
                            </el-table-column>
                          </el-table>
                        </div>
                      </el-card>
                    </el-collapse-item>
                  </el-collapse>
                </div>
              </div>